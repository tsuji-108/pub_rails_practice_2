<% content_for :title, @board.title %>

<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0">Board 詳細</h1>
  <%= link_to "掲示板一覧に戻る", boards_path, class: "btn btn-outline-secondary" %>
</div>

<%= render partial: "board", locals: { board: @board, show_actions: false } %>

<div class="d-flex flex-wrap gap-2 mt-4">
  <%= link_to "編集", edit_board_path(@board), class: "btn btn-secondary" %>
  <%= button_to "削除", @board, method: :delete, data: { turbo_confirm: "本当に削除しますか？" }, class: "btn btn-danger" %>
</div>

<hr>

<div class="mt-4">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h2 class="h5 mb-0"><%= @board.title %> のスレッド一覧</h2>
  </div>

  <% if @board.discussions.exists? %>
    <div class="list-group">
      <% @board.discussions.order(created_at: :desc).each do |discussion| %>
        <div class="list-group-item d-flex justify-content-between align-items-start">
          <div class="flex-fill">
            <div class="small text-muted">
              User id: <%= discussion.user.id %>
            </div>
            <div class="mt-1 text-truncate">
              <%= truncate(strip_tags(discussion.content.to_s), length: 160) %>
            </div>
          </div>
          <div class="ms-3">
            <%= link_to "詳細", discussion_path(discussion), class: "btn btn-outline-secondary btn-sm" %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="text-muted">まだディスカッションが登録されていません。</p>
  <% end %>
</div>

<div class="d-flex flex-wrap gap-2 mt-4">
  <%= link_to "スレッドを新規作成する", new_discussion_path(board_id: @board.id), class: "btn btn-primary" %>
</div>
